# Overview


# Build

- setup toolchain path - note this assumes you have our lede meta environment build tool (```bb.py```) in path. Also, the selected config (if not left to default configuration) has to for the **musl** libc toolchain as stated above.

```
cd to/braiinsos/
eval $(./bb.py toolchain 2>/dev/null)
```

- build:

```shell
cargo build
```

The resulting binary is in: ```target/arm-unknown-linux-musleabi/debug/rminer```. Currently, all musl targets are being statically linked - see here for details: https://github.com/japaric/rust-cross


# Testing
```shell
cargo test
```

This fails as cargo attempts to run the test case on the build host. However, it is possible to deploy the compiled test binary to the target. See below for dinghy and issues.

# Dinghy Integration (tool for deploying)

- this is currently incomplete as dinghy requires toolchain path and sysroot. The latter is a problem as we currently have no sysroot. The issue is being discussed here: https://github.com/snipsco/dinghy/issues/71

# Regenerating s9-io module

Peripheral module is autogenerated from a **fpga-io.xml**. The steps are currently manual:
```shell
svd2rust -i s9-io/fpga-io.xml --target none > lib.rs &&
form -i lib.rs -o s9-io/src/ &&
rm lib.rs &&
cargo fmt
```